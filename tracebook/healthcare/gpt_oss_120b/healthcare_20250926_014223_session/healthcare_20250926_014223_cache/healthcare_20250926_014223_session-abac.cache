
===============================================================
ITERATION : 1
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)


===============================================================
ITERATION : 0
===============================================================
# ABAC policy for a healthcare facility, e.g., a hospital.

# Note that the two words "user" and "subject" are used interchangeably in this document.

# Please refer to the policy description document for the detailed descriptions subject attributes and resource attributes. Note that some attributes might be irrelevant for some users and resources.


#------------------------------------------------------------
# user attribute data
#------------------------------------------------------------

# nurses

userAttrib(oncNurse1, position=nurse, ward=oncWard)
userAttrib(oncNurse2, position=nurse, ward=oncWard)

userAttrib(carNurse1, position=nurse, ward=carWard)
userAttrib(carNurse2, position=nurse, ward=carWard)

# doctors

userAttrib(oncDoc1, position=doctor, specialties={oncology}, teams={oncTeam1 oncTeam2})
userAttrib(oncDoc2, position=doctor, specialties={oncology}, teams={oncTeam1})
userAttrib(oncDoc3, position=doctor, specialties={oncology}, teams={oncTeam2})
userAttrib(oncDoc4, position=doctor, specialties={oncology}, teams={oncTeam2})

userAttrib(carDoc1, position=doctor, specialties={cardiology}, teams={carTeam1})
userAttrib(carDoc2, position=doctor, specialties={cardiology}, teams={carTeam2})

userAttrib(anesDoc1, position=doctor, specialties={anesthesiology}, teams={oncTeam1 carTeam1})

# the following doctors are not currently on any teams, but they have
# access to HR items they authored when they were on a team.
userAttrib(doc1, position=doctor, specialties={oncology pediatrics})
userAttrib(doc2, position=doctor, specialties={cardiology neurology})

# patients and agents

userAttrib(oncPat1, ward=oncWard)
userAttrib(oncPat2, ward=oncWard)

userAttrib(carPat1, ward=carWard)
userAttrib(carPat2, ward=carWard)

userAttrib(oncAgent1, agentFor={oncPat2})
userAttrib(oncAgent2, agentFor={oncPat2})
userAttrib(carAgent1, agentFor={carPat2})
userAttrib(carAgent2, agentFor={carPat2})

#------------------------------------------------------------
# resource attribute data
#------------------------------------------------------------

# resources for oncPat1
resourceAttrib(oncPat1oncItem, type=HRitem, author=oncDoc1, patient=oncPat1, topics={oncology}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1nursingItem, type=HRitem, author=oncNurse2, patient=oncPat1, topics={nursing}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1noteItem, type=HRitem, author=oncPat1, patient=oncPat1, topics={note}, treatingTeam=oncTeam1, ward=oncWard)
resourceAttrib(oncPat1HR, type=HR, patient=oncPat1, treatingTeam=oncTeam1, ward=oncWard)

# resources for oncPat2
resourceAttrib(oncPat2oncItem, type=HRitem, author=doc1, patient=oncPat2, topics={oncology}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2nursingItem, type=HRitem, author=oncNurse1, patient=oncPat2, topics={nursing}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2noteItem, type=HRitem, author=oncAgent1, patient=oncPat2, topics={note}, treatingTeam=oncTeam2, ward=oncWard)
resourceAttrib(oncPat2HR, type=HR, patient=oncPat2, treatingTeam=oncTeam2, ward=oncWard)

# resources for carPat1
resourceAttrib(carPat1carItem, type=HRitem, author=carDoc2, patient=carPat1, topics={cardiology}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1nursingItem, type=HRitem, author=carNurse1, patient=carPat1, topics={nursing}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1noteItem, type=HRitem, author=carPat1, patient=carPat1, topics={note}, treatingTeam=carTeam1, ward=carWard)
resourceAttrib(carPat1HR, type=HR, patient=carPat1, treatingTeam=carTeam1, ward=carWard)

# resources for carPat2
resourceAttrib(carPat2carItem, type=HRitem, author=doc2, patient=carPat2, topics={cardiology}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2nursingItem, type=HRitem, author=carNurse2, patient=carPat2, topics={nursing}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2noteItem, type=HRitem, author=carAgent1, patient=carPat2, topics={note}, treatingTeam=carTeam2, ward=carWard)
resourceAttrib(carPat2HR, type=HR, patient=carPat2, treatingTeam=carTeam2, ward=carWard)

Below is a compact ABAC policy that grants **exactly** the permissions that appear in the ACL.  
Each rule uses only attribute‑based conditions (no hard‑coded uid or rid values) and the operators defined in the specification.

```
# 1️⃣  Nurses can READ nursing‑item notes of patients that are in the same ward
rule(position [ {nurse} ]; type [ {HRitem} ]; topics ] nursing; {read}; ward = ward)

# 2️⃣  Nurses can ADD‑ITEM to a patient’s HR (the patient’s health‑record) when the ward matches
rule(position [ {nurse} ]; type [ {HR} ]; {addItem}; ward = ward)

# 3️⃣  Doctors can READ any HR‑item whose topics intersect the doctor’s specialties
rule(position [ {doctor} ]; type [ {HRitem} ]; {read}; specialties > topics)

# 4️⃣  Doctors can ADD‑ITEM to a patient’s HR when the patient’s treating team is one of the doctor’s teams
rule(position [ {doctor} ]; type [ {HR} ]; {addItem}; teams ] treatingTeam)

# 5️⃣  Agents (subjects that have a non‑empty *agentFor* set) can ADD‑NOTE to the HR of the patients they represent
rule(; type [ {HR} ]; {addNote}; agentFor ] patient)

# 6️⃣  Agents can READ a NOTE‑item that they authored (the author of the note must be the same UID as the subject)
rule(; type [ {HRitem} ]; topics ] note; {read}; uid = author)

# 7️⃣  Patients can ADD‑NOTE to their own HR (the patient’s UID appears as the subject’s UID and matches the HR’s patient)
rule(; type [ {HR} ]; {addNote}; uid = patient)

# 8️⃣  Patients can READ their own NOTE‑items (HR‑item with topic “note” belonging to them)
rule(; type [ {HRitem} ]; topics ] note; {read}; patient = patient)

```

**Explanation of the rules**

| Rule | Subject condition | Resource condition | Action(s) | Constraint (if any) |
|------|-------------------|--------------------|-----------|----------------------|
| 1️⃣ | `position` is *nurse* | `type` = *HRitem*, `topics` contains *nursing* | `read` | subject `ward` equals resource `ward` |
| 2️⃣ | `position` is *nurse* | `type` = *HR* | `addItem` | subject `ward` equals resource `ward` |
| 3️⃣ | `position` is *doctor* | `type` = *HRitem* | `read` | doctor’s `specialties` **superset** of resource `topics` (`specialties > topics`) |
| 4️⃣ | `position` is *doctor* | `type` = *HR* | `addItem` | doctor’s `teams` **contain** resource `treatingTeam` (`teams ] treatingTeam`) |
| 5️⃣ | – (empty) – | `type` = *HR* | `addNote` | subject’s `agentFor` **contains** resource `patient` (`agentFor ] patient`) |
| 6️⃣ | – (empty) – | `type` = *HRitem*, `topics` contains *note* | `read` | subject’s UID equals resource `author` (`uid = author`) |
| 7️⃣ | – (empty) – | `type` = *HR* | `addNote` | subject’s UID equals resource `patient` (`uid = patient`) |
| 8️⃣ | – (empty) – | `type` = *HRitem*, `topics` contains *note* | `read` | subject’s UID equals resource `patient` (`uid = patient`) |

These eight rules together reproduce every `(subject, resource, action)` triple listed in the ACL and nothing more, while respecting the required attribute‑based format.